CREATE TABLE custom_temp_screen_59
SELECT p.HOSPCODE,p.PID,concat(p.`NAME`,'  ',p.lname) AS NAME
,GROUP_CONCAT(c.CHRONIC) as 'CHRONIC'
,GROUP_CONCAT(n.DATE_SERV ORDER BY n.date_serv ASC) as 'DATE_SCREEN'
,GROUP_CONCAT(n.SCREENPLACE) as 'SCREEN_PLACE'
FROM person p
LEFT JOIN chronic c ON c.HOSPCODE=p.HOSPCODE AND c.PID=p.PID
AND (c.CHRONIC LIKE '%I%' OR c.CHRONIC LIKE '%E%') 

LEFT JOIN ncdscreen n ON n.HOSPCODE=p.HOSPCODE AND n.PID=p.PID
AND n.DATE_SERV BETWEEN '20151001' AND '20160930' AND n.pid<>''

WHERE p.TYPEAREA IN(1,3)
AND TIMESTAMPDIFF(YEAR,p.BIRTH,'20151001') >=35
AND p.DISCHARGE=9
GROUP BY p.HOSPCODE,p.PID,p.CID
HAVING CHRONIC IS NULL 
OR (NOT(CHRONIC LIKE '%I%' AND CHRONIC LIKE '%E%'))